---
title: "OSI Layer 와 Switch 장비"
excerpt_separator: "<!--more-->"
categories:
  - Infra
tags:
  - Network
  - Switch
sidebar:
  nav: "docs"
---
OSI Layer 의 각 계층에서 사용하는 네트워크 장비가 다른데, 유난히 스위치는 여러 계층에서 용도에 따라 다르게 사용되고 있지 않았는가? 각각의 계층에서 사용되는 스위치의 종류와, 실제 네트워크 상에서 어떻게 쓰이는지 알아보기로 했다.

## switch?

데이터(패킷)이 전달되어야 할 경로를 제공해주는 역할

개인적으로 「（データの）行き先を案内してくれる」 즉, (데이터의) 갈 곳을 안내해 준다는 표현이 마음에 들었다. 데이터의 안내자와 같은 우리 스위치...☆

## L2 스위치

- 가장 **일반적**인 방식의 스위치
- OSI 2 Layer 인 데이터링크 계층의 데이터를 스위칭하기 때문에, 스위칭에 사용하는 정보 단위는 **MAC 주소**
- 목적지 호스트의 MAC 주소를 보고 적절한 포트에 프레임을 전달한다.
- 주요 목적 : 같은 네트워크 내에 브로드캐스트 도메인 분할

## L3 스위치

- OSI 3 Layer 인 네트워크(인터넷) 계층의 데이터를 스위칭하기 때문에, 스위칭에 사용하는 정보 단위는 **IP 주소**
- L2 스위치에 **라우팅** 기능이 추가 : 네트워크 간의 패킷을 라우팅하는 역할을 수행
    - L3 스위치와 라우터의 차이점
        - L3 스위치는 LAN 내에 설치, 라우터는 LAN 과 WAN 사이에 설치
        - 라우터는 별도 NAT 기능을 포함함
        - 라우터는 VPN 이나 외부로부터 통신을 제어하는 기능을 포함함
- **VLAN** 기능 : IP 주소에 기초한 VLAN 분배와 VLAN 간의 라우팅을 수행
    - VLAN : 물리적으로 독립된 접속 형태를 가지는 가상의 LAN 네트워크

## L4 & L7 스위치

L4 스위치부터는 부하분산 기능을 사용할 수 있으므로, 서버의 헬스 체크가 가능하다

### L4 스위치

- OSI 4 Layer 인 전송 계층의 데이터를 스위칭하기 때문에, 스위칭에 사용하는 정보 단위는 **TCP/UDP 의 포트 정보**
- L3 스위치에 **부하분산(로드밸런싱)** 기능이 추가 : 요청받은 작업을 여러 서버로 분산시키는 역할을 수행
- **Failover** 기능 : 서버가 VIP 를 통해 서비스 중 중단되면 자동으로 다른 서버가 이어서 서비스를 수행
- 인식 가능한 포트 번호가 **0 ~ 1023** 번까지

### L7 스위치

- OSI 7 Layer 인 응용 계층의 데이터를 스위칭하기 때문에, 스위칭에 사용하는 정보 단위는 HTTP 등의 최상위 계층의 프로토콜 정보
- IP 나 포트 정보를 넘어 URL 정보나 쿠키 정보 등을 종합적으로 사용해서 스위칭
- L4 스위치는 인식 가능한 포트 번호가 한정되어 있으나, L7 스위치는 **모든 포트 번호를 인식**할 수 있다
- 가장 높은 수준의 스위치 : 정교한 데이터의 부하분산과 QoS 기능을 사용할 수 있다
    - QoS(Quality of Service) : 데이터 전송 등에 대해 특정 수준의 성능을 보장하기 위한 능력

## 어떤 스위치를 사용할까?

상위 레벨의 스위치는 하위 레벨 스위치의 기능을 포함한 기능이기 때문에, 단순하게 생각하면 어디든 L7 스위치를 사용하는 것이 좋다고 생각할 수도 있을 것이다. 

하지만 실제로 도입할 때에는 조금 더 영리하게 머리를 쓸 필요가 있다. 단적인 예로 기업에서 대규모로 네트워크 구축을 할 때 기능이 많다는 이유만으로 가장 높은 스펙의 장비를 사용하다가 그 비용을 어떻게 감당하겠는가...

그리고 실제 스위치를 사용할 때에는 해당 스위치가 가진 주력 기능만을 사용하는 경우가 많다고 한다. 예를 들어 L4 스위치의 경우, 기본적인 스위치의 기능은 물론 라우팅이나 VLAN 기능까지 모두 활용할 수 있는 장비이지만, 실제로는 로드밸런싱을 위해 사용한다고 봐도 무방한 것이다.

그렇기 때문에 실제 스위치를 도입할 때에는 실제 사용할 방법과 필요한 기능, 비용 측면까지 고려해서 적절히 혼합하여 배치해야 할 것이다.

## 참고

- [https://wiper2019.tistory.com/183?category=810434](https://wiper2019.tistory.com/183?category=810434)
- [https://qiita.com/yoyoyo_pg/items/fef3ddeb05989d03bbef](https://qiita.com/yoyoyo_pg/items/fef3ddeb05989d03bbef)
- [http://tooljp.com/windows/chigai/html/Switch/L2-L3-L4-L7-chigai.html](http://tooljp.com/windows/chigai/html/Switch/L2-L3-L4-L7-chigai.html)
- [https://kkamagistory.tistory.com/205](https://kkamagistory.tistory.com/205)
